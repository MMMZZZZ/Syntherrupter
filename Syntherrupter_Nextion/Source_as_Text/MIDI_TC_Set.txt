Page MIDI_TC_Set
    Attributes
        ID               : 0
        Scope            : local
        Send Component ID: disabled
        Locked           : no
    
    Events
        Preinitialize Event
            // Prevent page refreshs until postinit
            ref_stop
            //
            // Load colors
            click fLoadColors,1
            click fLoadModes,1
            //
            // Display username
            if(User_Settings.userNum.val==0)
            {
                tUser.txt=" "+User_Settings.u0Name.txt
            }else if(User_Settings.userNum.val==1)
            {
                tUser.txt=" "+User_Settings.u1Name.txt
            }else if(User_Settings.userNum.val==2)
            {
                tUser.txt=" "+User_Settings.u2Name.txt
            }
            //
            vis fLoadModes,0
            vis fLoadColors,0
            //
            // functions shall not be visible
            vis fConvBtnState,0
            vis fStore,0
            // Set page title
            covx coilNum.val,sCoilNum.txt,0,0
            tTitle.txt=sTitleStart.txt+sCoilNum.txt
            // Get coil data
            if(coilNum.val==1)
            {
                sys0=TC_Settings.coil1Chn.val
            }else if(coilNum.val==2)
            {
                sys0=TC_Settings.coil2Chn.val
            }else if(coilNum.val==3)
            {
                sys0=TC_Settings.coil3Chn.val
            }else if(coilNum.val==4)
            {
                sys0=TC_Settings.coil4Chn.val
            }else if(coilNum.val==5)
            {
                sys0=TC_Settings.coil5Chn.val
            }else if(coilNum.val==6)
            {
                sys0=TC_Settings.coil6Chn.val
            }
            // Get button states (format documented in Return button)
            fConvBtnState.val=sys0&0xffff
            // Get pan reach
            sys0=sys0>>16
            sReach.val=sys0&127
            // Get reach mode
            sys0=sys0>>7
            sys1=sys0&1
            if(sys1==0)
            {
                bLinConst.txt=sLinear.txt
            }else
            {
                bLinConst.txt=sConst.txt
            }
            // Get pan
            sys0=sys0>>1
            sPan.val=sys0&127
            // Get pan disabled
            // Note: Since this information is originally stored in the sign bit, we cannot directly assign the value (see https://nextion.tech/instruction-set/#s2_14 )
            sys0=sys0>>7
            if(sys0==0)
            {
                btPanDis.val=1
            }else
            {
                btPanDis.val=0
            }
            // Show button state
            click fConvBtnState,0
            click btPanDis,0
            //
            // Load Help Mode
            if(Help_Info.helpMode.val==0)
            {
                vis qrHelp,0
            }else
            {
                tempStr.txt=tTitle.txt
                showHelp.val=1
                click 0,1
            }
            //
            // Enable page refreshs again
            ref_star
        
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                if(Other_Settings.nBackOff.val!=0)
                {
                    // Default "stop" action.
                    // Send Mode Emergency Stop which turns all outputs off (but actually keeps the current mode)
                    prints "mes",3
                    // Set all ontime and duty settings of all pages to 0.
                    // First come the global variables then the local variables.
                    Simple.ontime.val=0
                    Simple.duty.val=0
                    Simple.set1.val=Simple.set1.val&0x0000ffff
                    Simple.set2.val=Simple.set2.val&0x0000ffff
                    Simple.set3.val=Simple.set3.val&0x0000ffff
                    Simple.set4.val=Simple.set4.val&0x0000ffff
                    Simple.set5.val=Simple.set5.val&0x0000ffff
                    Simple.set6.val=Simple.set6.val&0x0000ffff
                    MIDI_Live.ontime.val=0
                    MIDI_Live.duty.val=0
                    MIDI_Live.set1.val=0
                    MIDI_Live.set2.val=0
                    MIDI_Live.set3.val=0
                    MIDI_Live.set4.val=0
                    MIDI_Live.set5.val=0
                    MIDI_Live.set6.val=0
                    Lightsaber.ontime.val=0
                    Lightsaber.ontimes12.val=0
                    Lightsaber.ontimes34.val=0
                    Lightsaber.ontimes56.val=0
                }
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgP"
                click qrHelp,0
            }
        
Variable (int32) origin
    Attributes
        ID   : 6
        Scope: global
        Value: 0
    
Variable (string) sTitleStart
    Attributes
        ID            : 7
        Scope         : local
        Text          : Settings for Tesla Coil 
        Max. Text Size: 30
    
Variable (int32) coilNum
    Attributes
        ID   : 26
        Scope: global
        Value: 0
    
Variable (string) sCoilNum
    Attributes
        ID            : 27
        Scope         : local
        Text          : 0
        Max. Text Size: 1
    
Variable (string) sPanEn
    Attributes
        ID            : 31
        Scope         : local
        Text          : Enabled
        Max. Text Size: 8
    
Variable (string) sPanDis
    Attributes
        ID            : 32
        Scope         : local
        Text          : Disabled
        Max. Text Size: 8
    
Variable (string) sConst
    Attributes
        ID            : 40
        Scope         : local
        Text          : Const
        Max. Text Size: 6
    
Variable (string) sLinear
    Attributes
        ID            : 41
        Scope         : local
        Text          : Linear
        Max. Text Size: 6
    
Variable (string) sChnNum
    Attributes
        ID            : 46
        Scope         : local
        Text          : 0
        Max. Text Size: 2
    
Variable (string) tempStr
    Attributes
        ID            : 51
        Scope         : local
        Text          : 
        Max. Text Size: 32
    
Variable (int32) showHelp
    Attributes
        ID   : 52
        Scope: local
        Value: 0
    
Number fConvBtnState
    Attributes
        ID                 : 28
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Value              : 0
    
    Events
        Touch Press Event
            // Store button state in variable. Bit n corresponds to channel n.
            // sys0 only used because shorter, meaning better readable.
            sys0=0
            sys0+=btChn0.val
            sys0=sys0<<1
            sys0+=btChn1.val
            sys0=sys0<<1
            sys0+=btChn2.val
            sys0=sys0<<1
            sys0+=btChn3.val
            sys0=sys0<<1
            sys0+=btChn4.val
            sys0=sys0<<1
            sys0+=btChn5.val
            sys0=sys0<<1
            sys0+=btChn6.val
            sys0=sys0<<1
            sys0+=btChn7.val
            sys0=sys0<<1
            sys0+=btChn8.val
            sys0=sys0<<1
            sys0+=btChn9.val
            sys0=sys0<<1
            sys0+=btChn10.val
            sys0=sys0<<1
            sys0+=btChn11.val
            sys0=sys0<<1
            sys0+=btChn12.val
            sys0=sys0<<1
            sys0+=btChn13.val
            sys0=sys0<<1
            sys0+=btChn14.val
            sys0=sys0<<1
            sys0+=btChn15.val
            fConvBtnState.val=sys0
        
        Touch Release Event
            // Load button state from variable. Bit n corresponds to channel n.
            btChn0.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn1.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn2.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn3.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn4.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn5.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn6.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn7.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn8.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn9.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn10.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn11.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn12.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn13.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn14.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
            btChn15.val=fConvBtnState.val&1
            fConvBtnState.val>>=1
        
Number fStore
    Attributes
        ID                 : 44
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Value              : 0
    
    Events
        Touch Press Event
            // Serial Data format: 'd', Data Byte 1, 2, 3, 4, 5
            // Data byte 1:
            // Data byte 1:
            //   Bits 0-5: coils to which settings apply.
            //   Bits 6-7: Mode
            //     0b00 = MIDI TC Settings Change
            //     Other values = Not used here.
            // Data byte 2: Bit 0-7 correspond to channel 0-7
            // Data byte 3: Bit 0-7 correspond to channel 8-15
            // Data byte 4:
            //   Bit 0-6 contain the Pan value (0-127)
            //   Bit 7: 0: Pan enabled, 1: Pan disabled
            // Data Byte 5:
            //   Bit 0-6: Pan reach, ranging from 0-127. Notes within this range (abs(coilPanPos - notePanPos) <= panReach) will play on this coil.
            //   Bit 7:
            //     0 = linear mode. The volume of the note decreases linearly with the distance from the coil. At distance 0 the volume is equal to the notes volume. At the limit of the range the volume drops to 0.
            //     1 = constant mode. All notes within the range will play at their nominal volume.
            //
            //
            // Convert button state to bit array
            click fConvBtnState,1
            //
            // Add Pan data to sys0
            sys0=1-btPanDis.val
            sys0=sys0<<7
            sys0+=sPan.val
            // Add pan reach data to sys0
            sys0=sys0<<1
            if(bLinConst.txt==sConst.txt)
            {
                sys0+=1
            }
            sys0=sys0<<7
            sys0+=sReach.val
            sys0=sys0<<16
            //
            // Add button state bit array to sys0 and send the data
            sys0+=fConvBtnState.val
            //
            // sys1: coil bit. Note that coilNum ranges from 1-6 instead of 0-5
            sys1=1<<coilNum.val
            sys1=sys1>>1
            prints "d",1
            prints sys1,1
            prints sys0,4
            // Store settings in coil variable
            if(coilNum.val==1)
            {
                TC_Settings.coil1Chn.val=sys0
            }else if(coilNum.val==2)
            {
                TC_Settings.coil2Chn.val=sys0
            }else if(coilNum.val==3)
            {
                TC_Settings.coil3Chn.val=sys0
            }else if(coilNum.val==4)
            {
                TC_Settings.coil4Chn.val=sys0
            }else if(coilNum.val==5)
            {
                TC_Settings.coil5Chn.val=sys0
            }else if(coilNum.val==6)
            {
                TC_Settings.coil6Chn.val=sys0
            }
        
Text tHideBack
    Attributes
        ID                 : 1
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  
        Max. Text Size     : 1
    
    Events
        Touch Press Event
            // This is just to hide the background around the sliders so that you do not turn the outputs off by accident.
        
Text tHideBack1
    Attributes
        ID                 : 2
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  
        Max. Text Size     : 1
    
    Events
        Touch Press Event
            // This is just to hide the background around the sliders so that you do not turn the outputs off by accident.
        
Text tTitle
    Attributes
        ID                 : 3
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Settings for Tesla Coil 42
        Max. Text Size     : 30
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tChan
    Attributes
        ID                 : 5
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Assign MIDI channels:
        Max. Text Size     : 30
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tPan
    Attributes
        ID                 : 30
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Pan:
        Max. Text Size     : 20
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tL
    Attributes
        ID                 : 33
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : L
        Max. Text Size     : 20
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tR
    Attributes
        ID                 : 34
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : R
        Max. Text Size     : 20
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tPanReach
    Attributes
        ID                 : 36
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Reach:
        Max. Text Size     : 10
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tReachInfo
    Attributes
        ID                 : 38
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Distance from source at which the signal is no more audible. Same scale as pan slider.
        Max. Text Size     : 255
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tUser
    Attributes
        ID                 : 47
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               :  Guest
        Max. Text Size     : 32
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tMSI
    Attributes
        ID                 : 48
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Simple
        Max. Text Size     : 16
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tMML
    Attributes
        ID                 : 49
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : MIDI Live
        Max. Text Size     : 16
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
Text tMLS
    Attributes
        ID                 : 50
        Scope              : local
        Send Component ID  : disabled
        Associated Keyboard: none
        Text               : Lightsaber
        Max. Text Size     : 16
    
    Events
        Touch Press Event
            // Make this object "transparent" for clicks and click background.
            click 0,1
        
QR Code qrHelp
    Attributes
        ID               : 54
        Scope            : local
        Send Component ID: disabled
        Text             : git.io/JkvOK
        Max. Text Size   : 16
    
    Events
        Touch Release Event
            if(showHelp.val==0)
            {
                showHelp.val=1
                tempStr.txt=tTitle.txt
                tTitle.txt="Get Help/Link for..."
                // keep QR code on top
                ref qrHelp
                // Show modified title before stopping screen refreshs.
                doevents
                ref_stop
            }else
            {
                showHelp.val=0
                tTitle.txt=tempStr.txt
                // keep QR code on top
                ref qrHelp
                ref_star
            }
        
Slider sPan
    Attributes
        ID               : 29
        Scope            : local
        Send Component ID: disabled
        Position         : 64
        Upper range limit: 127
        Lower range limit: 0
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgS"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                if(sPan.val<=6)
                {
                    sPan.val=0
                }else if(sPan.val<=19)
                {
                    sPan.val=13
                }else if(sPan.val<=32)
                {
                    sPan.val=26
                }else if(sPan.val<=45)
                {
                    sPan.val=39
                }else if(sPan.val<=57)
                {
                    sPan.val=51
                }else if(sPan.val<=70)
                {
                    sPan.val=64
                }else if(sPan.val<=83)
                {
                    sPan.val=77
                }else if(sPan.val<=96)
                {
                    sPan.val=90
                }else if(sPan.val<=108)
                {
                    sPan.val=102
                }else if(sPan.val<=121)
                {
                    sPan.val=115
                }else
                {
                    sPan.val=127
                }
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Slider sReach
    Attributes
        ID               : 37
        Scope            : local
        Send Component ID: disabled
        Position         : 64
        Upper range limit: 127
        Lower range limit: 0
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                qrHelp.txt="git.io/Jkfg9"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                if(sReach.val<=6)
                {
                    sReach.val=0
                }else if(sReach.val<=19)
                {
                    sReach.val=13
                }else if(sReach.val<=32)
                {
                    sReach.val=26
                }else if(sReach.val<=45)
                {
                    sReach.val=39
                }else if(sReach.val<=57)
                {
                    sReach.val=51
                }else if(sReach.val<=70)
                {
                    sReach.val=64
                }else if(sReach.val<=83)
                {
                    sReach.val=77
                }else if(sReach.val<=96)
                {
                    sReach.val=90
                }else if(sReach.val<=108)
                {
                    sReach.val=102
                }else if(sReach.val<=121)
                {
                    sReach.val=115
                }else
                {
                    sReach.val=127
                }
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bReturn
    Attributes
        ID               : 4
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : Return
        Max. Text Size   : 10
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Since this code is also executed by the previous/next buttons, it can't be here, otherwise you would see a Touch Press Event on this button, too.
                click fStore,1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgQ"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Go back to origin page.
                page origin.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bNone
    Attributes
        ID               : 24
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : None
        Max. Text Size   : 6
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                btChn0.val=0
                btChn1.val=0
                btChn2.val=0
                btChn3.val=0
                btChn4.val=0
                btChn5.val=0
                btChn6.val=0
                btChn7.val=0
                btChn8.val=0
                btChn9.val=0
                btChn10.val=0
                btChn11.val=0
                btChn12.val=0
                btChn13.val=0
                btChn14.val=0
                btChn15.val=0
                click btChn0,0
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bAll
    Attributes
        ID               : 25
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : All
        Max. Text Size   : 6
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                btChn0.val=1
                btChn1.val=1
                btChn2.val=1
                btChn3.val=1
                btChn4.val=1
                btChn5.val=1
                btChn6.val=1
                btChn7.val=1
                btChn8.val=1
                btChn9.val=1
                btChn10.val=1
                btChn11.val=1
                btChn12.val=1
                btChn13.val=1
                btChn14.val=1
                btChn15.val=1
                click btChn0,0
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bLinConst
    Attributes
        ID               : 39
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : Linear
        Max. Text Size   : 6
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                qrHelp.txt="git.io/Jkfg9"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                if(bLinConst.txt==sLinear.txt)
                {
                    bLinConst.txt=sConst.txt
                }else
                {
                    bLinConst.txt=sLinear.txt
                }
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bPrevious
    Attributes
        ID               : 42
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : Previous
        Max. Text Size   : 10
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Save current state and send it to the microcontroller
                click fStore,1
                // Set previous coil
                if(coilNum.val>1)
                {
                    coilNum.val-=1
                }else
                {
                    coilNum.val=TC_Settings.maxCoilCount.val
                }
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgH"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Reload page for next coil
                page MIDI_TC_Set
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Button bNext
    Attributes
        ID               : 43
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : Next
        Max. Text Size   : 10
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Save current state and send it to the microcontroller
                click fStore,1
                // Set next coil
                if(coilNum.val<TC_Settings.maxCoilCount.val)
                {
                    coilNum.val+=1
                }else
                {
                    coilNum.val=1
                }
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgH"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Reload page for next coil
                page MIDI_TC_Set
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn0
    Attributes
        ID               : 8
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 0
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn0.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn1
    Attributes
        ID               : 9
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 1
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn1.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn2
    Attributes
        ID               : 10
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 2
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn2.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn3
    Attributes
        ID               : 11
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 3
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn3.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn8
    Attributes
        ID               : 12
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 8
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn8.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn9
    Attributes
        ID               : 13
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 9
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn9.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn10
    Attributes
        ID               : 14
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 10
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn10.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn11
    Attributes
        ID               : 15
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 11
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn11.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn4
    Attributes
        ID               : 16
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 4
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn4.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn5
    Attributes
        ID               : 17
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 5
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn5.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn6
    Attributes
        ID               : 18
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 6
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn6.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn7
    Attributes
        ID               : 19
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 7
        Max. Text Size   : 2
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn7.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn12
    Attributes
        ID               : 20
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 12
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn12.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn13
    Attributes
        ID               : 21
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 13
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn13.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn14
    Attributes
        ID               : 22
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 14
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn14.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btChn15
    Attributes
        ID               : 23
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : 15
        Max. Text Size   : 3
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
                sChnNum.txt=btChn15.txt
                tmButtonHold.en=1
            }else
            {
                // Show Help
                qrHelp.txt="git.io/JkfgD"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                // Stop and reset timer that detects long hold.
                tmButtonHold.en=0
                tmButtonHold.tim=Other_Settings.nHoldTime.val
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Dual-state Button btPanDis
    Attributes
        ID               : 35
        Scope            : local
        Send Component ID: disabled
        State            : unpressed
        Text             : Disabled
        Max. Text Size   : 8
    
    Events
        Touch Press Event
            if(showHelp.val==0)
            {
                // Normal Operation
            }else
            {
                // Show Help
                // Undo button toggle
                btPanDis.val=1-btPanDis.val
                qrHelp.txt="git.io/Jkfgy"
            }
        
        Touch Release Event
            if(showHelp.val==0)
            {
                // Normal Operation
                if(btPanDis.val==0)
                {
                    btPanDis.txt=sPanDis.txt
                    vis tL,0
                    vis sPan,0
                    vis tR,0
                    vis tPanReach,0
                    vis sReach,0
                    vis tReachInfo,0
                    vis bLinConst,0
                }else
                {
                    btPanDis.txt=sPanEn.txt
                    vis tL,1
                    vis sPan,1
                    vis tR,1
                    vis tPanReach,1
                    vis sReach,1
                    vis tReachInfo,1
                    vis bLinConst,1
                }
            }else
            {
                // Show Help
                click qrHelp,0
            }
        
Hotspot fLoadModes
    Attributes
        ID               : 53
        Scope            : local
        Send Component ID: disabled
    
    Events
        Touch Press Event
            // Load active modes
            sys0=Settings.activeModes.val&4
            if(sys0!=0)
            {
                // Lightsaber Mode is active
                tMLS.bco=Settings.backSelectCol2.val
            }
            //
            // Display all active modes
            sys0=Settings.activeModes.val&1
            if(sys0!=0)
            {
                // Simple Mode is active
                tMSI.bco=Settings.backSelectCol2.val
            }
            sys0=Settings.activeModes.val&2
            if(sys0!=0)
            {
                // MIDI Live Mode is active
                tMML.bco=Settings.backSelectCol2.val
            }
        
Hotspot fLoadColors
    Attributes
        ID               : 55
        Scope            : local
        Send Component ID: disabled
    
    Events
        Touch Press Event
            // Changes all page components according to the current color set.
            // Note: This component has to be the last component of the page.
            //
            // sys0: component id
            // sys1: component type
            // sys2: picture id offset for current color mode
            sys2=Settings.colorMode.val*Settings.picCount.val
            for(sys0=0;sys0<fLoadColors.id;sys0++)
            {
                // More convenient for typing
                sys1=b[sys0].type
                if(sys1==121)
                {
                    // Types that have bco
                    // page
                    if(b[sys0].bco==Settings.backCol2Deflt.val)
                    {
                        b[sys0].bco=Settings.backCol2.val
                    }else
                    {
                        b[sys0].bco=Settings.backCol.val
                    }
                }else if(sys1==54||sys1==59||sys1==116||sys1==55)
                {
                    // Types that have bco, pco, and sta:
                    // number, float, text, scroll text
                    if(b[sys0].sta==1)
                    {
                        if(b[sys0].bco==Settings.backCol2Deflt.val)
                        {
                            b[sys0].bco=Settings.backCol2.val
                            b[sys0].pco=Settings.frontCol2.val
                        }else
                        {
                            b[sys0].bco=Settings.backCol.val
                            b[sys0].pco=Settings.frontCol.val
                        }
                    }
                }else if(sys1==98||sys1==53)
                {
                    // Types that have pco, pic, pco2, pic2, sta:
                    // button, dual-state button
                    if(b[sys0].sta==2)
                    {
                        b[sys0].pco=Settings.frontCol.val
                        b[sys0].pco2=Settings.backCol.val
                        b[sys0].pic=b[sys0].pic%Settings.picCount.val
                        b[sys0].pic+=sys2
                        b[sys0].pic2=b[sys0].pic+1
                    }
                }else if(sys1==58)
                {
                    // Types that have bco, pco
                    // QR Code
                    b[sys0].bco=Settings.backCol.val
                    b[sys0].pco=Settings.qrFrontCol.val
                }else if(sys1==1)
                {
                    // Types that have pic, pic1, pic2:
                    // slider
                    b[sys0].pic=b[sys0].pic%Settings.picCount.val
                    b[sys0].pic+=sys2
                    b[sys0].pic1=b[sys0].pic
                    b[sys0].pic2=b[sys0].pic2%Settings.picCount.val
                    b[sys0].pic2+=sys2
                }
            }
        
Timer tmButtonHold
    Attributes
        ID         : 45
        Scope      : local
        Period (ms): 400
        Enabled    : no
    
    Events
        Timer Event
            tmButtonHold.en=0
            MIDI_Chn_Set.origin.val=dp
            covx sChnNum.txt,MIDI_Chn_Set.chnNum.val,0,0
            // Button has been hold, not pressed. Revert state change.
            if(sChnNum.txt==btChn0.txt)
            {
                btChn0.val=1-btChn0.val
            }else if(sChnNum.txt==btChn1.txt)
            {
                btChn1.val=1-btChn1.val
            }else if(sChnNum.txt==btChn2.txt)
            {
                btChn2.val=1-btChn2.val
            }else if(sChnNum.txt==btChn3.txt)
            {
                btChn3.val=1-btChn3.val
            }else if(sChnNum.txt==btChn4.txt)
            {
                btChn4.val=1-btChn4.val
            }else if(sChnNum.txt==btChn5.txt)
            {
                btChn5.val=1-btChn5.val
            }else if(sChnNum.txt==btChn6.txt)
            {
                btChn6.val=1-btChn6.val
            }else if(sChnNum.txt==btChn7.txt)
            {
                btChn7.val=1-btChn7.val
            }else if(sChnNum.txt==btChn8.txt)
            {
                btChn8.val=1-btChn8.val
            }else if(sChnNum.txt==btChn9.txt)
            {
                btChn9.val=1-btChn9.val
            }else if(sChnNum.txt==btChn10.txt)
            {
                btChn10.val=1-btChn10.val
            }else if(sChnNum.txt==btChn11.txt)
            {
                btChn11.val=1-btChn11.val
            }else if(sChnNum.txt==btChn12.txt)
            {
                btChn12.val=1-btChn12.val
            }else if(sChnNum.txt==btChn13.txt)
            {
                btChn13.val=1-btChn13.val
            }else if(sChnNum.txt==btChn14.txt)
            {
                btChn14.val=1-btChn14.val
            }else if(sChnNum.txt==btChn15.txt)
            {
                btChn15.val=1-btChn15.val
            }
            // Store settings before leaving the page
            click fStore,1
            page MIDI_Chn_Set
        
